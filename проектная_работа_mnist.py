# -*- coding: utf-8 -*-
"""Проектная работа MNIST.ipynb


# Ссылка на Google Collab с графиками и результатами  ------> https://colab.research.google.com/drive/1R7W57_IxWvCi7Pi55U2qXAAKrAvi8sHS?usp=sharing#scrollTo=y6l7SCaNWYCb


Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1R7W57_IxWvCi7Pi55U2qXAAKrAvi8sHS

# Описание набора данных

База данных MNIST - это коллекция рукописных цифр, широко используемая в машинном обучении и компьютерном зрении. Она состоит из 70 000 черно-белых изображений, включающих 60 000 примеров для обучения и 10 000 примеров для тестирования. Каждое изображение представляет собой матрицу размером 28x28 пикселей и содержит рукописную цифру от 0 до 9. Датасет содержит метки классов, что означает, что каждому изображению соответствует правильная цифра, которую оно представляет. MNIST является популярным эталоном для задач, таких как распознавание цифр, классификация изображений и оценка алгоритмов в области машинного обучения.

Вот как выглядит наш Dataset

![mnist_data.jpg](data:image/jpeg;base64,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)

# Обработка данных
"""

import tensorflow as tf
from tensorflow import keras
from tensorflow.keras.datasets import mnist
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, Flatten
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
import cv2

# Загрузим набор данных MNIST
(x_train, y_train), (x_test, y_test) = mnist.load_data()

"""
Для подготовки изображений для модели многослойного перцептрона необходимо преобразовать их в вектор пикселей. Это означает, что изображения размером 28x28 будут представлены в виде одного вектора из 784 значений пикселей.

Для выполнения этого преобразования мы можем использовать функцию reshape() в библиотеке NumPy. Эта функция позволяет изменить форму массива изображений в векторный формат. Кроме того, мы можем оптимизировать использование памяти, указав точность значений пикселей как 32-битную, что помогает сократить требования к памяти."""

# Подготовим входные данные
x_train = x_train.reshape((x_train.shape[0],-1))
x_test = x_test.reshape((x_test.shape[0], -1))

x_train = x_train.astype('float32')
x_test = x_test.astype('float32')

print(x_train.shape, x_test.shape)

"""Значения пикселей в оттенках серого варьируются от 0 до 255. Обычно рекомендуется масштабировать входные значения при использовании моделей нейронных сетей. Поскольку шкала значений пикселей хорошо определена и предсказуема, мы легко можем нормализовать их в диапазоне от 0 до 1, разделив каждое значение на максимальное значение 255. Этот процесс нормализации позволяет достичь лучшей совместимости и эффективности во время обучения нейронной сети."""

# Нормализация входных данных
x_train = x_train / 255.0
x_test = x_test / 255.0

x_train.shape

"""# Постановка задачи и построение модели

Наша задача - построить самую лучшую модель которая точнее всего будет определят цифры на основе рукописных изображений.

Для этого, мы построим 3 модели с разными оптимизаторами (RMSprop, adam, sgd) и с разным количеством скрытых слоев

Первую модель построим с 3 скрытыми слоями и RMSprop оптимайзиром
"""

# Построим модель №1
model1 = Sequential()
model1.add(Flatten(input_shape=(784,)))
model1.add(Dense(300, activation='relu'))
model1.add(Dense(100,activation='relu'))
model1.add(Dense(100,activation='relu'))
model1.add(Dense(10, activation='softmax'))

# Задаем параметры модели
model1.compile(optimizer='RMSprop',
              loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])

# Тренируем модель с колличеством эпох - 20
history1 = model1.fit(x_train , y_train , epochs = 20 , validation_data = (x_test, y_test))

"""Активация - это функция активации слоя. Здесь используется функция активации ReLU (Rectified Linear Activation) для первых слоев.
Эта функция выдает значение 0, если входное значение является отрицательным числом, и возвращает то же самое входное значение, если оно является положительным числом. Простыми словами, ReLU->max(0, входное значение). Эта функция активации хорошо себя показывает в нейронных сетях в терминах скорости и вывода.

Flatten служит связующим звеном между сверточными и полносвязными слоями.

'Dense' - это тип слоя, который используется для выходного слоя. Dense является стандартным типом слоя, который используется во многих случаях для нейронных сетей.

Функция активации для последнего слоя - 'softmax'. Softmax приводит сумму выходных значений к 1, так что выход содержит серию вероятностей.

Командой history запишем значения loss и accuracy на тренированном и тестовом наборе данных, для дальнейшего сравнения.

Построим вторую модель с 3 скрытыми слоями и adam оптимайзер
"""

# Построим модель №2
model2 = Sequential()
model2.add(Flatten(input_shape=(784,)))
model2.add(Dense(300, activation='relu'))
model2.add(Dense(100,activation='relu'))
model2.add(Dense(100,activation='relu'))
model2.add(Dense(10, activation='softmax'))

# Задаем параметры модели
model2.compile(optimizer='adam',
              loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])

# Тренируем модель с колличеством эпох - 20
history2 = model2.fit(x_train , y_train , epochs = 20 , validation_data = (x_test, y_test))

"""Построим третью модель с 3 скрытыми слоями и sgd оптимайзер"""

# Построим модель №3
model3 = Sequential()
model3.add(Flatten(input_shape=(784,)))
model3.add(Dense(300, activation='relu'))
model3.add(Dense(100,activation='relu'))
model3.add(Dense(100,activation='relu'))
model3.add(Dense(10, activation='softmax'))

# Задаем параметры модели
model3.compile(optimizer='sgd',
              loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])

# Тренируем модель с колличеством эпох - 20
history3 = model3.fit(x_train , y_train , epochs = 20 , validation_data = (x_test, y_test))

"""Сравнение графиков loss моделей"""

y = np.array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19])
loss1 = history1.history['loss']
val_loss1 = history1.history['val_loss']
accuracy1 = history1.history['accuracy']
val_accuracy1 = history1.history['val_accuracy']

loss2 = history2.history['loss']
val_loss2 = history2.history['val_loss']
accuracy2 = history2.history['accuracy']
val_accuracy2 = history2.history['val_accuracy']

loss3 = history3.history['loss']
val_loss3 = history3.history['val_loss']
accuracy3 = history3.history['accuracy']
val_accuracy3 = history3.history['val_accuracy']

plt.plot(y, val_loss1, label="val_loss_RMS")
plt.plot(y, val_loss2, label="val_loss_ADAM")
plt.plot(y, val_loss3, label="val_loss_SGD")
plt.legend()
plt.show()

"""Сравниваем графики accuracy моделей"""

plt.plot(y, val_accuracy1, label="val_accuracy_RMS")
plt.plot(y, val_accuracy2, label="val_accuracy_ADAM")
plt.plot(y, val_accuracy3, label="val_accuracy_RGS")
plt.legend()
plt.show()

"""После сравнения трёх моделей, мы выбрали лучшую - adam, с наилучшим соотношением accuracy и loss. Теперь исследуем эту модел, изменяя колличество скрытых слоев. В первом опыте - 3 слоя. Во втором - 4 слоя. В третьем - 2 слоя."""

# Построим модель №4 c 4 скрытыми слоями
model4 = Sequential()
model4.add(Flatten(input_shape=(784,)))
model4.add(Dense(300, activation='relu'))
model4.add(Dense(100,activation='relu'))
model4.add(Dense(100,activation='relu'))
model4.add(Dense(200,activation='relu'))
model4.add(Dense(10, activation='softmax'))

# Задаем параметры модели
model4.compile(optimizer='adam',
              loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])

# Тренируем модель с колличеством эпох - 20
history4 = model4.fit(x_train , y_train , epochs = 20 , validation_data = (x_test, y_test))

# Построим модель №5 c 2 скрытыми слоями
model5 = Sequential()
model5.add(Flatten(input_shape=(784,)))
model5.add(Dense(300, activation='relu'))
model5.add(Dense(150,activation='relu'))
model5.add(Dense(10, activation='softmax'))

# Задаем параметры модели
model5.compile(optimizer='adam',
              loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])

# Тренируем модель с колличеством эпох - 20
history5 = model5.fit(x_train , y_train , epochs = 20 , validation_data = (x_test, y_test))

"""Построим графики сравнения loss и accuracy полученных моделей adam с 3, 4 и 2 скрытыми слоями"""

val_loss4 = history4.history['val_loss']
val_accuracy4 = history4.history['val_accuracy']

val_loss5 = history5.history['val_loss']
val_accuracy5 = history5.history['val_accuracy']

plt.plot(y, val_loss2, label="val_loss_ADAM_3")
plt.plot(y, val_loss4, label="val_loss_ADAM_4")
plt.plot(y, val_loss5, label="val_loss_ADAM_2")
plt.legend()
plt.show()

plt.plot(y, val_accuracy2, label="val_accuracy_ADAM_3")
plt.plot(y, val_accuracy4, label="val_accuracy_ADAM_4")
plt.plot(y, val_accuracy5, label="val_accuracy_ADAM_2")
plt.legend()
plt.show()

"""Можем заметить, что по окончанию 20 эпох Adam с 4 слоями. Сейчас мы проверим эти три модели на реальном фото, нарисованным нами в Paint, где изображены цифры 33351.  В честь нашей группы R33351.

# Тестирование моделей
"""

# Evaluate the model
test_loss1, test_acc1 = model1.evaluate(x_test, y_test, verbose=0)
test_loss2, test_acc2 = model2.evaluate(x_test, y_test, verbose=0)
test_loss3, test_acc3 = model3.evaluate(x_test, y_test, verbose=0)
print('Test accuracy1:', test_acc1)
print('Test accuracy2:', test_acc2)
print('Test accuracy3:', test_acc3)

"""Протестируем нашу полученную модель на нашем реальном наборе данных, нарисованных нами в Paint.
Необходимо выполнить обработку изображения и преобразовать его в матрицу единиц и нулей.
"""

image = cv2.imread('./test4.jpg')
grey = cv2.cvtColor(image.copy(), cv2.COLOR_BGR2GRAY) # преобразуем в серый
ret, thresh = cv2.threshold(grey.copy(), 75, 255, cv2.THRESH_BINARY_INV) #бинаризуем бело-черную картинку, присваивая цифрам белый цвет, а остальное черным

contours, hier = cv2.findContours(thresh.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)
preprocessed_digits = []
for c in contours:
    x,y,w,h = cv2.boundingRect(c)

    # CОбводим контуры в изображении
    cv2.rectangle(image, (x,y), (x+w, y+h), color=(0, 255, 0), thickness=2)

    # Обрезаем число по контуру
    digit = thresh[y:y+h, x:x+w]

    # Меняем размерность
    resized_digit = cv2.resize(digit, (18,18))

    # Добавлем несколько пикселей по контуру, чтобы не обрезать лишнее
    padded_digit = np.pad(resized_digit, ((5,5),(5,5)), "constant", constant_values=0)

    # Добавляем выделенную цифру, как предобработанную
    preprocessed_digits.append(padded_digit)
print("\n\n\n----------------Contoured Image--------------------")
plt.imshow(image, cmap="gray")
plt.show()

inp = np.array(preprocessed_digits)

"""Мы успешно распознали границы цифр и теперь настроим модель на распознавание"""

for digit in preprocessed_digits:
    prediction = model5.predict(digit.reshape(1, 784))  # Adam с 2 слоями

    print ("\n\n---------------------------------------\n\n")
    print ("=========PREDICTION============ \n\n")
    plt.imshow(digit.reshape(28, 28), cmap="gray")
    plt.show()
    print("\n\nFinal Output: {}".format(np.argmax(prediction)))


    hard_maxed_prediction = np.zeros(prediction.shape)
    hard_maxed_prediction[0][np.argmax(prediction)] = 1
    print ("\n\nHard-maxed form of the prediction: \n\n {}".format(hard_maxed_prediction))
    print ("\n\n---------------------------------------\n\n")

"""Мы несколько раз тестировали каждую модель adam и в результате лучшей моделью на данном наборе оказался Adam с 2 слоями - он корректно разобрал все цифры. Adam с 3 слоями ошибся 1 раз, а Adam с 4 слоями ошибся 4 раза.

Наша вторая модель - ADAM с 2 скрытыми слоями - смогла корректно распознать наши данные. В некоторых случаях модель ошибалась. Например, это связано с тем, что сначала мы изображали единицу с хвостиком, а у модели заложено расположение единицы больше как палки.

# Итоговый результат

Графики loss и accuracy для лучшей модели  -  Adam с 2 скрытыми слоями
"""

pd.DataFrame(history5.history).plot(figsize = (14,5))
plt.grid(True)
plt.gca().set_ylim(0 , 1)

"""# Вывод

В данной работе мы работали с набором данных Mnist и занимались разработкой модели, способной распозновать цифры, написанные от руки. Мы испробовали такие оптимайзеры как RMS, adam, sgd. RMS и adam показали себя лучше всех, и дальнейше мы исследовали adam на изменение скрытых слоев. Они не внесли однозначных изменений связанных с accuracy, однако мы протестировали их на нашем собсвтенном наборе данных. Мы нарисовали числа в paint, подключили обработку изображений и тестировали модели adam. Лучшей себя показала модель Adam с 2 скрытыми слоями - она смогла предсказать все нарисованные цифры
"""
